
<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <title>Haftalık Zıplama Antrenmanı</title>
  <style>
    body { font-family: Arial; padding: 20px; }
    h1 { color: #333; }
    .day { margin-bottom: 10px; padding: 10px; border-radius: 5px; border: 1px solid #ccc; }
    .completed { background-color: #c8f7c5; }
    .incomplete { background-color: #f7c5c5; }
    .upcoming { background-color: #fff3c5; }
  </style>
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
    import { getFirestore, doc, setDoc, getDoc } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyAUN-2vTAJ47_Gqu1CCakODKL3UwSXg41E",
      authDomain: "ziplama-3d74f.firebaseapp.com",
      projectId: "ziplama-3d74f",
      storageBucket: "ziplama-3d74f.firebasestorage.app",
      messagingSenderId: "774323479140",
      appId: "1:774323479140:web:444009f163d15f15f5b571",
      measurementId: "G-PVX9F2M743"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    const gunler = ["Pazartesi", "Salı", "Çarşamba", "Perşembe", "Cuma", "Cumartesi", "Pazar"];

    function getDateOfThisWeek(dayIndex) {
      const now = new Date();
      const first = now.getDate() - now.getDay() + 1 + dayIndex;
      const target = new Date(now.setDate(first));
      return target.toISOString().split("T")[0];
    }

    async function loadWeek() {
      const container = document.getElementById("week");
      const todayStr = new Date().toISOString().split("T")[0];

      for (let i = 0; i < 7; i++) {
        const date = getDateOfThisWeek(i);
        const ref = doc(db, "antrenmanlar", date);
        const docSnap = await getDoc(ref);

        const div = document.createElement("div");
        div.className = "day";
        div.id = "div_" + date;

        const label = document.createElement("label");
        label.innerText = gunler[i] + " (" + date + ")";

        const checkbox = document.createElement("input");
        checkbox.type = "checkbox";
        checkbox.dataset.date = date;
        checkbox.onchange = kaydet;

        if (docSnap.exists()) {
          const durum = docSnap.data().durum;
          if (durum === "Tamamlandı") {
            checkbox.checked = true;
            div.classList.add("completed");
          } else {
            div.classList.add("incomplete");
          }
        } else {
          div.classList.add("upcoming");
        }

        div.appendChild(label);
        div.appendChild(document.createElement("br"));
        div.appendChild(checkbox);
        container.appendChild(div);
      }
    }

    async function kaydet(e) {
      const date = e.target.dataset.date;
      const durum = e.target.checked ? "Tamamlandı" : "Yapılmadı";
      await setDoc(doc(db, "antrenmanlar", date), {
        tarih: date,
        durum: durum
      });
      const div = document.getElementById("div_" + date);
      div.classList.remove("completed", "incomplete", "upcoming");
      div.classList.add(durum === "Tamamlandı" ? "completed" : "incomplete");
    }

    window.onload = loadWeek;
  </script>
</head>
<body>
  <h1>Haftalık Zıplama Antrenmanı Takibi</h1>
  <div id="week"></div>
</body>
</html>
